{"meta":{"title":"The Blog Of Ysanyu","subtitle":"ysanyu的个人博客","description":"记录工作中和学习时遇到的疑难杂症","author":"ysanyu","url":"https://ysanyu.github.io","root":"/"},"pages":[{"title":"关于我","date":"2021-07-23T06:45:43.000Z","updated":"2021-07-23T07:37:39.555Z","comments":true,"path":"about.html","permalink":"https://ysanyu.github.io/about.html","excerpt":"","text":"本站基于hexo 脚手架搭建，主题为步步走，全站部署在github"}],"posts":[{"title":"小程序、vue的一些解决方案汇总","slug":"小程序的一些解决方案","date":"2021-07-26T06:18:23.000Z","updated":"2021-07-26T06:35:56.045Z","comments":true,"path":"2021/07/26/小程序的一些解决方案/","link":"","permalink":"https://ysanyu.github.io/2021/07/26/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","excerpt":"开发过程中有时候会有些需求，常规的方法并不能解决问题。此文介绍下一些解决方案 &emsp;","text":"开发过程中有时候会有些需求，常规的方法并不能解决问题。此文介绍下一些解决方案 &emsp; 小程序获取头部高度12345678910// 获取头部高度 wx.getSystemInfo(&#123; success: e =&gt; &#123; let pixelRatio = 750 / e.windowWidth this.globalData.pixelRatio = pixelRatio this.globalData.statusBar = e.statusBarHeight; this.globalData.headerHeight = 44; this.globalData.customBar = e.statusBarHeight + this.globalData.headerHeight; &#125; &#125;) 移动端判断浏览器环境1234567891011const ua = navigator.userAgent;// 微信浏览器if(ua.toLowerCase().indexOf(&#x27;micromessenger&#x27;) &gt; -1)&#123; console.log(&#x27;微信浏览器&#x27;)&#125;// 安卓还是苹果if(ua.indexOf(&quot;Android&quot;) &gt; -1 || ua.indexOf(&quot;Adr&quot;) &gt; -1)&#123; console.log(&#x27;安卓环境&#x27;)&#125;else&#123; console.log(&#x27;苹果环境&#x27;)&#125; 其他富文本解决方案123456789101112131415161718192021222324/*** 处理富文本里的图片宽度自适应* 1.去掉img标签里的style、width、height属性* 2.img标签添加style属性：max-width:100%;height:auto* 3.修改所有style里的width属性为max-width:100%* 4.去掉&lt;br/&gt;标签* @param html* @returns &#123;void|string|*&#125;*/ formatRichText(html) &#123; let newContent = html.replace(/&lt;img[^&gt;]*&gt;/gi, function (match, capture) &#123; match = match.replace(/style=&quot;[^&quot;]+&quot;/gi, &#x27;&#x27;); match = match.replace(/width=&quot;[^&quot;]+&quot;/gi, &#x27;&#x27;); match = match.replace(/height=&quot;[^&quot;]+&quot;/gi, &#x27;&#x27;); return match; &#125;) newContent = newContent.replace(/style=&quot;[^&quot;]+&quot;/gi, function (match, capture) &#123; match = match.replace(/width:[^;]+;/gi, &#x27;max-width:100%;&#x27;).replace(/width:[^;]+;/gi, &#x27;max-width:100%;&#x27;); return match; &#125;) newContent = newContent.replace(/&lt;br[^&gt;]*\\/&gt;/gi, &#x27;&#x27;) newContent = newContent.replace(/\\&lt;img/gi, &#x27;&lt;img style=&quot;max-width:100%;height:auto;display:block;margin-top:0;margin-bottom:0;&quot;&#x27;); return newContent; &#125;","categories":[{"name":"vue","slug":"vue","permalink":"https://ysanyu.github.io/categories/vue/"},{"name":"小程序","slug":"小程序","permalink":"https://ysanyu.github.io/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"移动端","slug":"移动端","permalink":"https://ysanyu.github.io/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"},{"name":"h5","slug":"h5","permalink":"https://ysanyu.github.io/categories/h5/"}],"tags":[{"name":"vue","slug":"vue","permalink":"https://ysanyu.github.io/tags/vue/"},{"name":"移动端","slug":"移动端","permalink":"https://ysanyu.github.io/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"},{"name":"小程序","slug":"小程序","permalink":"https://ysanyu.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"h5","slug":"h5","permalink":"https://ysanyu.github.io/tags/h5/"}]},{"title":"h5表单的安卓适配（监测键盘弹起和收起）","slug":"h5表单的安卓适配（监测键盘弹起和收起）","date":"2021-07-23T07:23:04.000Z","updated":"2021-07-26T06:35:51.440Z","comments":true,"path":"2021/07/23/h5表单的安卓适配（监测键盘弹起和收起）/","link":"","permalink":"https://ysanyu.github.io/2021/07/23/h5%E8%A1%A8%E5%8D%95%E7%9A%84%E5%AE%89%E5%8D%93%E9%80%82%E9%85%8D%EF%BC%88%E7%9B%91%E6%B5%8B%E9%94%AE%E7%9B%98%E5%BC%B9%E8%B5%B7%E5%92%8C%E6%94%B6%E8%B5%B7%EF%BC%89/","excerpt":"在移动端开发中提交表单，苹果端显示正常，但是在安卓上显示异常，顶起键盘会让输入框顶到莫名其妙的位置。本文旨在解决这种怪异的样式问题。 &emsp;","text":"在移动端开发中提交表单，苹果端显示正常，但是在安卓上显示异常，顶起键盘会让输入框顶到莫名其妙的位置。本文旨在解决这种怪异的样式问题。 &emsp; 定义初始高度1234567data()&#123; return &#123; screenHeight: document.body.clientHeight, // 这里是给到了一个默认值 originHeight: document.body.clientHeight, // 默认高度在watch里拿来做比较 isOriginHei: true // 这个属性是固定定位按钮的显隐开关(需要就加，不需要隐藏） &#125;&#125; created里面判断类型1234567891011const ua = navigator.userAgent;const self = this;if (ua.indexOf(&quot;Android&quot;) &gt; -1 || ua.indexOf(&quot;Adr&quot;) &gt; -1) &#123; this.platform = &quot;android&quot;; window.onresize = () =&gt; &#123; return (() =&gt; &#123; // 获取视图变化时屏幕高度 self.screenHeight = document.body.clientHeight; &#125;)(); &#125;; &#125; watch监听视图变化123456789101112131415161718192021watch: &#123; screenHeight(val) &#123; // 判断软键盘弹出，收起 const that = this; if (this.originHeight - val &gt; 50) &#123; // 键盘弹出 that.$nextTick(() =&gt; &#123; const y = that.$refs[that.dom].offsetTop - 80; document.body.scrollTop = y; document.documentElement.scrollTop = y; window.scrollTo(0, y); &#125;); &#125; else &#123; // 键盘收起 document.body.scrollTop = 0; document.documentElement.scrollTop = 0; window.scrollTo(0, 0); &#125; &#125;&#125;","categories":[{"name":"vue","slug":"vue","permalink":"https://ysanyu.github.io/categories/vue/"},{"name":"移动端","slug":"移动端","permalink":"https://ysanyu.github.io/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"}],"tags":[{"name":"vue","slug":"vue","permalink":"https://ysanyu.github.io/tags/vue/"},{"name":"移动端","slug":"移动端","permalink":"https://ysanyu.github.io/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"}]}],"categories":[{"name":"vue","slug":"vue","permalink":"https://ysanyu.github.io/categories/vue/"},{"name":"小程序","slug":"小程序","permalink":"https://ysanyu.github.io/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"移动端","slug":"移动端","permalink":"https://ysanyu.github.io/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"},{"name":"h5","slug":"h5","permalink":"https://ysanyu.github.io/categories/h5/"}],"tags":[{"name":"vue","slug":"vue","permalink":"https://ysanyu.github.io/tags/vue/"},{"name":"移动端","slug":"移动端","permalink":"https://ysanyu.github.io/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"},{"name":"小程序","slug":"小程序","permalink":"https://ysanyu.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"h5","slug":"h5","permalink":"https://ysanyu.github.io/tags/h5/"}]}